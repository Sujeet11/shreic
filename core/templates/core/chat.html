{% extends 'core/base.html' %}
{% block content %}
<h4 class="mb-4">Chat with {{ other_user.username }}</h4>

<div class="border rounded p-3 mb-3 bg-light" style="max-height: 400px; overflow-y: auto;">
  {% for msg in messages %}
    {% if msg.sender == user %}
      <!-- Sent message -->
      <div class="text-end mb-2">
        <span class="badge bg-primary">{{ msg.message }}</span><br>
        <small class="text-muted">{{ msg.timestamp|date:"H:i" }}</small>
      </div>
    {% else %}
      <!-- Received message -->
      <div class="text-start mb-2">
        <span class="badge bg-secondary">{{ msg.sender.username }}: {{ msg.message }}</span><br>
        <small class="text-muted">{{ msg.timestamp|date:"H:i" }}</small>
      </div>
    {% endif %}
  {% endfor %}
</div>

<form method="post" class="d-flex">
  {% csrf_token %}
  {{ form.message }}
  <button class="btn btn-success ms-2" type="submit">Send</button>
</form>
{% endblock %}
